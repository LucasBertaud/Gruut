{% extends 'base.html.twig' %}

{% block title %}Nos Produits
{% endblock %}

{% block css %}
	<link rel="stylesheet" href="{{ asset("assets/css/product.css") }}">
{% endblock %}

{% block content %}
	<header id="head" class="secondary"></header>

	<style>
		.secondary {
			background: none !important;
		}

		.row1 {
			display: flex;
			flex-direction: row;
			flex-wrap: wrap;
			align-content: center;
			justify-content: center;
			align-items: center;
		}

		

	</style>

<div class="container">
	<div class="row">
		<div class="col-md-12 text-center">
			<h1 class="text-center">Catégorie
				<br>{{categories.name}}
			</h1>	
			
			<div class="row1 row" style="margin-top:5vh;">
				{% for product in categories.products %}
				
					{# <div class="col-md-4" style="height: 350px">
						<a href="{{ path ('product_show', { 'slug' : product.slug } ) }}"><img src="{{asset('assets/images/')}}{{product.illustration}}" alt="{{ product.name }}" class="img-fluid" width="150px"></a>


						<div class="describe" style="height:50px;">
							<h4>{{product.name}}</h4>
							<span class="product-subtitle">
								{{ product.subtitle }}
							</span>
						</div> #}


						<div class="col-md-3" style="height: 350px; margin:1vw; float:left;">
							{# <div class="card-img"> <a href="{{ path ('product_show', { 'slug' : product.slug } ) }}"><img src="{{asset('assets/images/')}}{{product.illustration}}" alt="{{ product.name }}" class="img-fluid" width="150px" style="border-radius:5px; min-height:150px;" ></a></div>
								<div class="card-info">
									<p class="text-title">{{product.name}}</p>		
									<p class="text-body">{{ product.subtitle }}</p>
								</div>
								<div class="card-footer">
								{% if  product.stock > 0 %}
									<span id="price-product" class="text-title">{{ (product.price / 100) |number_format(2, ",",".") }}€</span>
									<div class="card-button" {% if  product.stock < 1 %} id="card-button-empty" {% endif %}>
										
											<a href="{{path("cart_add", {"id" : product.id})}}" class="click"><img src="{{asset("assets/images/group12.png")}}" alt="commander" class="blink"></a>			
										{% else %}
											<div class="text-danger" data-toggle="tooltip" data-placement="top"><i class="fa-solid fa-triangle-exclamation" style="font-size:25px; margin-right:1vw"></i> Rupture de stock, Désolé !</div>
										{% endif %}
									</div> #}
							

								{% include 'product/single.html.twig'%}
						</div>
						{# <div class="flexbyme ">
							<h3 style="font-weight: bolder" class="product-price">
								<span style="text-decoration: underline">{{ (product.price / 100) |number_format(2, ",",".") }}€</span>
								{% if  product.stock > 0 %}
									<a href="{{path("cart_add", {"id" : product.id})}}" class="click"><img src="{{asset("assets/images/group12.png")}}" alt="commander"></a>
								{% else %}
									<p class="text-danger">Produit temporairement en rupture de stock</p>

								{% endif %}
							</h3>
						</div> #}

					{# </div> #}
					

				{% endfor %}
			</div>
		</div>
	</div>
</div>

{% endblock %}

 {% block script %}
 
 <script>
 
	var click1 = document.getElementsByClassName('click');
	var nbPanier = document.querySelector('.notify-badge');
	var cardButtons = document.querySelectorAll('.card-button');


for(var i=0; i<click1.length; i++){

	click1[i].addEventListener ("click", () => {
			nbPanier.classList.add("animation");
			
	})
}

cardButtons.forEach(function(cardButton){
cardButton.addEventListener("click", () => {
	cardButton.classList.add("animationcard");
} )
	} 	 
)


let inputsQuantity = document.querySelectorAll(".quantityCart");
let hrefs = document.querySelectorAll(".click");
let inputOfValue = 1;

arrayInputs = Array.from(inputsQuantity).map(function (inputQuantity) {
	return inputQuantity;
});
arrayInputs.forEach(function (input, index) {
	var href = hrefs[index];
	href.addEventListener("click", function(){
		inputValue = input.value
		if(inputValue > 100) {
			inputValue = 0
		}
		cartHref = href.href;
		$.ajax({
			type: "POST",
			url: cartHref,
			data: {inputOfValue: inputValue},
		});
	});
});
 </script>
 
 {% endblock %}